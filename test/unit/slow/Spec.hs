import Data.Word

import Hash

-- Salsa20^n

salsa20Input1 :: [Word32]
salsa20Input1 = [
    6, 124, 83, 146,
    38, 191, 9, 50,
    4, 161, 47, 222,
    122, 182, 223, 185,
    75, 27, 0, 216,
    16, 122, 7, 89,
    162, 104, 101, 147,
    213, 21, 54, 95,
    225, 253, 139, 176,
    105, 132, 23, 116, 
    76, 41, 176, 207,
    221, 34, 157, 108,
    94, 94, 99, 52,
    90, 117, 91, 220,
    146, 190, 239, 143,
    196, 176, 130, 186]

salsa20Output1 :: [Word32]
salsa20Output1 = [
    8, 18, 38, 199,
    119, 76, 215, 67,
    173, 127, 144, 162,
    103, 212, 176, 217,
    192, 19, 233, 33,
    159, 197, 154, 160,
    128, 243, 219, 65,
    171, 136, 135, 225,
    123, 11, 68, 86,
    237, 82, 20, 155,
    133, 189, 9, 83,
    167, 116, 194, 78,
    122, 127, 195, 185,
    185, 204, 188, 90,
    245, 9, 183, 248,
    226, 85, 245, 104]

main :: IO ()
main = do
    putStrLn "Salsa20 tests:"
    putStrLn $ if salsa20powerCompute salsa20Input1 1000000 == salsa20Output1 then "OK" else "FAIL!"

    putStrLn ""

    return ()
